<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>天幕SDK测试</title>
</head>
<body>
<button onclick="weixinLogin()">微信授权登录</button>
<div id="loginResult"></div>
<button id="sdkInitBtn" onclick="sdkInit()" disabled>SDK初始化</button>
<div id="initResult"></div>
<button id="weixinPayBtn" onclick="weixinPay()" disabled>微信支付</button>
<div id="payResult"></div>
<button id="weixinOrderQueryBtn" onclick="weixinOrderQuery()" disabled>微信定单查询</button>
<div id="payQueryResult"></div>
<button id="identifyBtn" onclick="identify()" disabled>实名认证</button>
<div id="identifyResult"></div>
<button id="identifyQueryBtn" onclick="identifyQuery()" disabled>实名认证查询</button>
<div id="identifyQueryResult"></div>
</body>
<script>
    let loginData;
    let payOrder;

    function pageFinished() {
        console.log("页面加载完成");
    }

    /**
     * 微信登录
     */
    function weixinLogin() {
        window.android.weixinLogin();
    }

    /**
     * 微信登录回调
     * @param data
     */
    function weixinLoginCallback(data) {
        loginData = data;
        let dataStr = JSON.stringify(data);
        document.querySelector("#loginResult").innerHTML = dataStr;
        console.log("微信授权登录回调 " + dataStr);
        if (loginData.data && loginData.data.open_id) {
            document.querySelector("#sdkInitBtn").removeAttribute("disabled");
            document.querySelector("#weixinPayBtn").removeAttribute("disabled");
            document.querySelector("#identifyBtn").removeAttribute("disabled");
            document.querySelector("#identifyQueryBtn").removeAttribute("disabled");
        }
    }

    /**
     * sdk初始化
     */
    function sdkInit() {
        let result = window.android.initSdk(loginData.data.open_id, "channel");
        document.querySelector("#initResult").innerHTML = result;
        console.log("初始化结果", result);
    }

    /**
     * 调用微信支付
     */
    function weixinPay() {
        window.android.weixinPay(1, loginData.data.open_id, "test")
    }

    /**
     * 支付回调结果
     * @param data
     */
    function weixinPayCallback(data) {
        payOrder = data;
        let dataStr = JSON.stringify(data);
        document.querySelector("#payResult").innerHTML = dataStr;
        if (data.orderId) {
            document.querySelector("#weixinOrderQueryBtn").removeAttribute("disabled");
        }
        console.log("微信支付回调 " + dataStr);
    }

    /**
     * 微信支付定单查询
     */
    function weixinOrderQuery() {
        let result = window.android.queryOrder(payOrder.orderId);
        document.querySelector("#payQueryResult").innerHTML = result;
        console.log("微信定单查询结果 " + result);
    }

    /**
     * 实时认证查询
     */
    function identifyQuery() {
        let result = window.android.identifyQuery(loginData.data.open_id);
        document.querySelector("#identifyQueryResult").innerHTML = result;
        console.log("实时认证查询结果 " + result);
    }

    /**
     * 实时认证
     */
    function identify() {
        let result = window.android.identify(loginData.data.open_id, "李德松", "452525197305054416");
        document.querySelector("#identifyResult").innerHTML = result;
        console.log("实时认证结果 " + result);
    }


</script>
<style>
    button {
        margin: 10px;
    }

    div {
        border: 1px solid #ccc;
        padding: 10px;
    }
</style>
</html>